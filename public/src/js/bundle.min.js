function renderModal(){var e=document.querySelector(".modal-container"),e=(e&&e.remove(),document.createElement("DIV")),t=(e.classList.add("modal-container"),document.createElement("DIALOG")),a=(t.classList.add("modal"),document.createElement("FORM")),a=(a.classList.add("form"),createInputs([{tag:"LABEL",classess:["form__label"],attributes:{htmlFor:"title",textContent:"Title"}},{tag:"INPUT",classess:["form__input"],attributes:{type:"text",name:"title",id:"title",placeholder:"Movie title"}},{tag:"LABEL",classess:["form__label"],attributes:{htmlFor:"year",textContent:"Year"}},{tag:"INPUT",classess:["form__input"],attributes:{type:"number",name:"year",id:"year",placeholder:"Movie year"}},{tag:"LABEL",classess:["form__label"],attributes:{htmlFor:"genres",textContent:"Genres"}},{tag:"INPUT",classess:["form__input"],attributes:{type:"text",name:"genres",id:"genres",placeholder:'Movie genres separated by "," '}},{tag:"LABEL",classess:["form__label","form__label--image"],attributes:{htmlFor:"image",textContent:"Click to upload an image"}},{tag:"INPUT",classess:["form__input","form__input--image"],attributes:{type:"file",accept:".jpg,.webp,.png,.jpge",name:"image",id:"image"}},{tag:"BUTTON",classess:["form__button","form__button--cancel"],attributes:{textContent:"Cancel"}},{tag:"BUTTON",classess:["form__button","form__button--save"],attributes:{textContent:"Save changes"}}],a),t.appendChild(a),e.appendChild(t),document.createDocumentFragment()),t=(a.appendChild(e),document.querySelector(".main"));document.body.insertBefore(a,t),createCancelButton()}function createCancelButton(){document.querySelector(".form__button--cancel").addEventListener("click",e=>{e.preventDefault();var e=document.querySelector(".modal"),t=document.querySelector(".modal-container");e.close(),t.remove()})}function createElement(e,t,a){var n,o,s=document.createElement(e);for(n of t)s.classList.add(n);for(o in a)s[o]=a[o];return s}function createInputs(t,a){for(let e=0;e<t.length;e+=2){var n=document.createElement("DIV"),o=("BUTTON"!==t[e].tag?n.classList.add("form__field","form__field--"+t[e+1].attributes.name):n.classList.add("form__actions"),t[e].classess.includes("form__label--image")&&((o=document.createElement("LABEL")).classList.add("form__label"),o.textContent="Image",n.appendChild(o)),createElement(t[e].tag,t[e].classess,t[e].attributes)),s=createElement(t[e+1].tag,t[e+1].classess,t[e+1].attributes);n.appendChild(o),n.appendChild(s),a.appendChild(n)}}(async()=>{async function c(){var e=new URLSearchParams(window.location.search).get("page"),{movies:t,pages:a}=await(await fetch("/api/movies?page="+e)).json();return{pagination:{pages:a,page:parseInt(e)},movies:t}}async function s(){let o=document.querySelector(".movies");o&&(o.innerHTML="");var e,t=(await c()).movies;0<t.length&&(e=document.createDocumentFragment(),t.forEach(e=>{e=e,(t=document.createElement("DIV")).classList.add("movie"),t.dataset.id=e._id,a=(e=>{var t=document.createElement("DIV"),a=(t.classList.add("movie__poster-container"),document.createElement("IMG"));return a.classList.add("movie__poster"),a.src=e.poster??"https://kzmnnrx7q0ns0pyx3ccz.lite.vusercontent.net/placeholder.svg?height=450&width=300",a.alt=e.title,t.appendChild(a),t})(e),n=(e=>{let t=document.createElement("DIV"),a=(t.classList.add("movie__content"),document.createElement("DIV")),n=(a.classList.add("movie__header"),document.createElement("H2")),o=(n.classList.add("movie__heading"),n.title=e.title,n.textContent=e.title,document.createElement("SPAN")),s=(o.classList.add("movie__year"),o.textContent=e.year,a.appendChild(n),a.appendChild(o),document.createElement("DIV"));return s.classList.add("movie__genres"),e.genres.forEach(e=>{var t=document.createElement("P");t.classList.add("movie__genre"),t.textContent=e,s.appendChild(t)}),t.appendChild(a),t.appendChild(s),t})(e),e=(({_id:e})=>{var t=document.createElement("DIV"),a=(t.classList.add("movie__actions"),document.createElement("BUTTON")),n=(a.classList.add("movie__action","movie__action--edit"),a.title="Edit movie",a.onclick=()=>{renderModal(),document.querySelector(".modal").showModal()},document.createElement("IMG"));n.classList.add("movie__action-icon"),n.src="/src/images/pencil.svg",n.alt="pen icon",a.append(n);(n=document.createElement("BUTTON")).classList.add("movie__action","movie__action--delete"),n.title="Delete movie",n.onclick=()=>{(async e=>{var{state:t,msg:a}=await(t=await fetch("/"+e,{method:"DELETE"})).json(),t=(1===t&&document.querySelector(`[data-id='${e}']`).remove(),a),e=document.querySelector(".alerts"),a=(e&&e.remove(),(e=document.createElement("DIV")).classList.add("alerts"),document.createElement("P")),n=(a.classList.add("alert","text-center"),a.textContent=t,e.appendChild(a),(t=document.querySelector("main")).insertBefore(e,document.querySelector(".movies")),e);setTimeout(()=>{n.remove()},1500),s()})(e)};var o=document.createElement("IMG");return o.classList.add("movie__action-icon"),o.src="/src/images/trash.svg",o.alt="trash icon",n.appendChild(o),t.appendChild(a),t.appendChild(n),t})(e),n.appendChild(e),t.appendChild(a),t.appendChild(n);var t,a,n,e=t;o.appendChild(e)}),e.appendChild(o),document.querySelector("main").insertBefore(e,document.querySelector(".pagination")))}(async()=>{var t,{pages:e,page:a}=e=(await c()).pagination,n=document.querySelector(".pagination__next"),o=document.querySelector(".pagination__prev"),n=(a<e&&(n.href="?page="+(a+1)),1===a?o.classList.add("hidden"):(o.href="?page="+(a-1),o.classList.remove("hidden")),Math.max(1,a-5)),s=Math.min(e,a+5+1),r=document.querySelector(".pagination__numbers");for(let e=n;e<s;e++)e===a?((t=document.createElement("SPAN")).classList.add("pagination__current-page"),t.textContent=e,r.appendChild(t)):((t=document.createElement("A")).textContent=e,t.classList.add("pagination__page"),t.href="?page="+e,r.appendChild(t))})(),s()})();
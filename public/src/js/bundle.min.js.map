{"version":3,"file":"bundle.min.js","sources":["bundle.min.js"],"sourcesContent":["(async function () {\r\n    async function getMoviesData() {\r\n        const params = new URLSearchParams(window.location.search);\r\n        const page = params.get(\"page\");\r\n\r\n        try {\r\n            const res = await fetch(`/api/movies?page=${page}`);\r\n\r\n            const data = await res.json();\r\n\r\n            const { movies, pages } = data;\r\n            return {\r\n                pagination: {\r\n                    pages: parseInt(pages),\r\n                    page: parseInt(page),\r\n                },\r\n                movies: movies,\r\n            };\r\n        } catch (e) {\r\n            showAlert(\"404 not found\");\r\n            const pagination = document.querySelector(\".pagination\");\r\n            pagination.remove();\r\n            return;\r\n        }\r\n    }\r\n\r\n    renderMovies();\r\n    async function renderMovies() {\r\n        const moviesC = document.querySelector(\".movies\");\r\n        while (moviesC.children.length > 0) {\r\n            moviesC.firstElementChild.remove();\r\n        }\r\n        const { movies } = await getMoviesData();\r\n        if (movies.length > 0) {\r\n            const frgm = document.createDocumentFragment();\r\n            movies.forEach((movie) => {\r\n                const movieC = createMovieElements(movie);\r\n                frgm.appendChild(movieC);\r\n            });\r\n\r\n            moviesC.appendChild(frgm);\r\n        }\r\n    }\r\n\r\n    function createMovieElements(movie) {\r\n        const movieC = document.createElement(\"DIV\");\r\n        movieC.classList.add(\"movie\");\r\n        movieC.dataset.id = movie._id;\r\n\r\n        const posterC = createPoster(movie);\r\n\r\n        const content = createContent(movie);\r\n\r\n        const actions = createActions(movie);\r\n\r\n        content.appendChild(actions);\r\n        movieC.appendChild(posterC);\r\n        movieC.appendChild(content);\r\n        return movieC;\r\n    }\r\n\r\n    function createPoster(movie) {\r\n        const posterC = document.createElement(\"DIV\");\r\n        posterC.classList.add(\"movie__poster-container\");\r\n        const poster = document.createElement(\"IMG\");\r\n        poster.classList.add(\"movie__poster\");\r\n        poster.src =\r\n            movie.poster ??\r\n            \"https://kzmnnrx7q0ns0pyx3ccz.lite.vusercontent.net/placeholder.svg?height=450&width=300\";\r\n        poster.alt = movie.title;\r\n        poster.loading = \"lazy\";\r\n        poster.width = 280;\r\n        poster.heigth = 420;\r\n        posterC.appendChild(poster);\r\n        return posterC;\r\n    }\r\n\r\n    function createContent(movie) {\r\n        const content = document.createElement(\"DIV\");\r\n        content.classList.add(\"movie__content\");\r\n\r\n        const header = document.createElement(\"DIV\");\r\n        header.classList.add(\"movie__header\");\r\n\r\n        const h2 = document.createElement(\"H2\");\r\n        h2.classList.add(\"movie__heading\");\r\n        h2.title = movie.title;\r\n        h2.textContent = movie.title;\r\n\r\n        const year = document.createElement(\"SPAN\");\r\n        year.classList.add(\"movie__year\");\r\n        year.textContent = movie.year;\r\n\r\n        header.appendChild(h2);\r\n        header.appendChild(year);\r\n\r\n        const genres = document.createElement(\"ul\");\r\n        genres.classList.add(\"movie__genres\");\r\n        movie.genres.forEach((g) => {\r\n            const genre = document.createElement(\"li\");\r\n            genre.classList.add(\"movie__genre\");\r\n            genre.textContent = g;\r\n            genres.appendChild(genre);\r\n        });\r\n\r\n        content.appendChild(header);\r\n        content.appendChild(genres);\r\n\r\n        return content;\r\n    }\r\n\r\n    function createActions({ _id }) {\r\n        const actions = document.createElement(\"DIV\");\r\n        actions.classList.add(\"movie__actions\");\r\n\r\n        const editBtn = document.createElement(\"BUTTON\");\r\n        editBtn.classList.add(\"movie__action\", \"movie__action--edit\");\r\n        editBtn.title = \"Edit movie\";\r\n        editBtn.onclick = (e) => {\r\n            showForm(e);\r\n        };\r\n\r\n        const editBtnIcon = document.createElement(\"IMG\");\r\n        editBtnIcon.classList.add(\"movie__action-icon\");\r\n        editBtnIcon.src = \"/src/images/pencil.svg\";\r\n        editBtnIcon.alt = \"pen icon\";\r\n        editBtn.append(editBtnIcon);\r\n\r\n        const deleteBtn = document.createElement(\"BUTTON\");\r\n        deleteBtn.classList.add(\"movie__action\", \"movie__action--delete\");\r\n        deleteBtn.title = \"Delete movie\";\r\n        deleteBtn.onclick = () => {\r\n            deleteMovie(_id);\r\n        };\r\n\r\n        const deleteBtnIcon = document.createElement(\"IMG\");\r\n        deleteBtnIcon.classList.add(\"movie__action-icon\");\r\n        deleteBtnIcon.src = \"/src/images/trash.svg\";\r\n        deleteBtnIcon.alt = \"trash icon\";\r\n\r\n        deleteBtn.appendChild(deleteBtnIcon);\r\n\r\n        actions.appendChild(editBtn);\r\n        actions.appendChild(deleteBtn);\r\n        return actions;\r\n    }\r\n\r\n    async function deleteMovie(movieId) {\r\n        try {\r\n            const res = await fetch(`/${movieId}`, {\r\n                method: \"DELETE\",\r\n            });\r\n            const { state, msg } = await res.json();\r\n            if (state === 1) {\r\n                const movie = document.querySelector(`[data-id='${movieId}']`);\r\n                movie.remove();\r\n            }\r\n            showAlert(msg);\r\n        } catch (e) {\r\n            showAlert(\"404 not found, movie couldn't be deleted\");\r\n        }\r\n        renderMovies();\r\n    }\r\n\r\n    function showAlert(msg, remove = true) {\r\n        const alerts = document.querySelector(\".alerts\");\r\n        const alert = document.createElement(\"P\");\r\n        alert.classList.add(\"alert\", \"text-center\");\r\n        alert.textContent = msg;\r\n        if (alerts.children.length < 0) {\r\n            alerts.appendChild(alert);\r\n        }\r\n        deleteAlert(alert);\r\n    }\r\n\r\n    function deleteAlert(element) {\r\n        setTimeout(() => {\r\n            element.remove();\r\n        }, 1500);\r\n    }\r\n\r\n    function showForm(e) {\r\n        modal.showModal();\r\n        const movieId = e.target.closest(\".movie\").dataset.id;\r\n        try {\r\n            fetch();\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n    }\r\n})();\r\nconst modal = document.querySelector(\".modal\");\r\n\n(function () {\r\n    const cancelButton = document.querySelector(\".form__button--cancel\");\r\n    cancelButton.addEventListener(\"click\", (e) => {\r\n        e.preventDefault();\r\n        modal.close();\r\n    });\r\n})();\r\n"],"names":["async","renderMovies","moviesC","document","querySelector","children","length","firstElementChild","remove","movies","await","page","URLSearchParams","window","location","search","get","pages","fetch","json","pagination","parseInt","e","showAlert","frgm","createDocumentFragment","forEach","movie","movieC","createElement","classList","add","dataset","id","_id","posterC","poster","src","alt","title","loading","width","heigth","appendChild","content","header","h2","year","textContent","genres","genre","g","actions","editBtn","editBtnIcon","onclick","showForm","modal","showModal","target","closest","console","log","append","deleteBtn","movieId","state","msg","method","deleteBtnIcon","element","alerts","alert","setTimeout","addEventListener","preventDefault","close"],"mappings":"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"}